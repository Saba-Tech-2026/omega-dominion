<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ğŸš¢ Marine Shipping Dashboard</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #0b1c2d;
            color: #ffffff;
            padding: 20px;
        }

        h1 {
            color: #4da6ff;
        }

        .card {
            background: #142c44;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
        }

        input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border-radius: 5px;
            border: none;
        }

        button {
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            background: #4da6ff;
            font-weight: bold;
            cursor: pointer;
        }

        pre {
            background: #000;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
        }

        .profit {
            color: #4dff88;
            font-size: 18px;
        }

        .error {
            color: #ff4d4d;
        }
    </style>
</head>
<body>

<h1>ğŸš¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø¨Ø­Ø±ÙŠ Ø§Ù„Ø°ÙƒÙŠ</h1>

<!-- Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© -->
<div class="card">
    <h3>ğŸ“¦ Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>

    <input id="origin" placeholder="Ù…ÙŠÙ†Ø§Ø¡ Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ (Ù…Ø«Ø§Ù„: PORT-A)">
    <input id="destination" placeholder="Ù…ÙŠÙ†Ø§Ø¡ Ø§Ù„ÙˆØµÙˆÙ„ (Ù…Ø«Ø§Ù„: PORT-B)">

    <button onclick="createShipment()">Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø©</button>

    <p id="shipmentId"></p>
</div>

<!-- ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø© -->
<div class="card">
    <h3>ğŸ“¡ ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø©</h3>
    <button onclick="trackShipment()">ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØªØ¨Ø¹</button>

    <div id="dashboard"></div>
</div>

<script>
/* ==========================
   Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©
========================== */
const BASE_URL = "http://127.0.0.1:8080";
let currentShipment = null;

/* ==========================
   Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø©
========================== */
async function createShipment() {
    const origin = document.getElementById("origin").value;
    const destination = document.getElementById("destination").value;

    if (!origin || !destination) {
        alert("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙŠÙ†Ø§Ø¡ Ø§Ù„Ø§Ù†Ø·Ù„Ø§Ù‚ ÙˆØ§Ù„ÙˆØµÙˆÙ„");
        return;
    }

    try {
        const res = await fetch(`${BASE_URL}/api/marine/create`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                origin: origin,
                destination: destination
            })
        });

        if (!res.ok) throw new Error("ÙØ´Ù„ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø­Ù†Ø©");

        const data = await res.json();
        currentShipment = data.shipment_id;

        document.getElementById("shipmentId").innerHTML =
            `âœ… Ø±Ù‚Ù… Ø§Ù„Ø´Ø­Ù†Ø©: <b>${currentShipment}</b>`;

    } catch (err) {
        document.getElementById("shipmentId").innerHTML =
            `<span class="error">âŒ ${err.message}</span>`;
    }
}

/* ==========================
   ØªØªØ¨Ø¹ Ø§Ù„Ø´Ø­Ù†Ø©
========================== */
async function trackShipment() {
    if (!currentShipment) {
        alert("Ø£Ù†Ø´Ø¦ Ø´Ø­Ù†Ø© Ø£ÙˆÙ„Ù‹Ø§");
        return;
    }

    try {
        const res = await fetch(
            `${BASE_URL}/api/marine/track/${currentShipment}`
        );

        if (!res.ok) throw new Error("ÙØ´Ù„ Ø§Ù„ØªØªØ¨Ø¹");

        const data = await res.json();

        document.getElementById("dashboard").innerHTML = `
            <b>ğŸš¢ Ø±Ù‚Ù… Ø§Ù„Ø´Ø­Ù†Ø©:</b> ${data.system.shipment_id}<br>
            <b>ğŸ“¦ Ø§Ù„Ø­Ø§Ù„Ø©:</b> ${data.system.status}<br><br>

            <b>ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ:</b> ${data.globe.position.join(", ")}<br>
            <b>ğŸ¯ Ø§Ù„ÙˆØ¬Ù‡Ø©:</b> ${data.globe.destination}<br>
            <b>â³ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</b> ${data.globe.eta_hours} Ø³Ø§Ø¹Ø©<br>
            <b>âš ï¸ Ø§Ù„Ù…Ø®Ø§Ø·Ø±:</b> ${data.globe.threat}<br><br>

            <b class="profit">ğŸ’° Ø±Ø¨Ø­ Ø§Ù„Ø±Ø­Ù„Ø©:</b>
            ${data.finance.trip_profit} ${data.finance.currency}<br>

            <b>ğŸ›ƒ Ø§Ù„ØªØ®Ù„ÙŠØµ Ø§Ù„Ø¬Ù…Ø±ÙƒÙŠ:</b> ${data.customs.status}
        `;

    } catch (err) {
        document.getElementById("dashboard").innerHTML =
            `<span class="error">âŒ ${err.message}</span>`;
    }
}
</script>

</body>
</html>