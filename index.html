<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ğŸš¢ Marine Shipping Control</title>
<style>
body{
    background:#050d18;
    color:#00ffcc;
    font-family: monospace;
    padding:20px;
}
button{
    padding:10px 15px;
    background:#00ffcc;
    border:none;
    font-weight:bold;
    cursor:pointer;
    margin:5px 0;
}
select{
    padding:8px;
    width:100%;
    margin:5px 0;
}
pre{
    background:#000;
    padding:15px;
    border-radius:8px;
}
.card{
    border:1px solid #00ffcc;
    padding:15px;
    margin-bottom:15px;
}
</style>
</head>
<body>

<h2>ğŸŒ Ù†Ø¸Ø§Ù… Ø§Ù„Ø´Ø­Ù† Ø§Ù„Ø¨Ø­Ø±ÙŠ Ø§Ù„Ø°ÙƒÙŠ</h2>

<div class="card">
    <button onclick="createShipment()">â• Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø­Ù†Ø© Ø¬Ø¯ÙŠØ¯Ø©</button>
    <div id="status"></div>
</div>

<div class="card">
    <label>ğŸ“¦ Ø§Ø®ØªØ± Ø§Ù„Ø´Ø­Ù†Ø©:</label>
    <select id="shipmentList" onchange="selectShipment()">
        <option value="">-- Ø§Ø®ØªØ± --</option>
    </select>
</div>

<div class="card">
    <h3>ğŸ“¡ Ø§Ù„ØªØªØ¨Ø¹ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</h3>
    <pre id="output">Ø¨Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØªØ¨Ø¹...</pre>
</div>

<script>
let shipments = {};
let currentShipment = null;
let autoTrack = null;

function addShipment(id){
    shipments[id] = true;
    const opt = document.createElement("option");
    opt.value = id;
    opt.textContent = "ğŸš¢ Ø´Ø­Ù†Ø© " + id;
    document.getElementById("shipmentList").appendChild(opt);
}

function selectShipment(){
    currentShipment = document.getElementById("shipmentList").value;
    if(autoTrack) clearInterval(autoTrack);
    autoTrack = setInterval(trackShipment, 3000);
}

async function createShipment(){
    const res = await fetch("http://127.0.0.1:8080/api/marine/create", {
        method: "POST"
    });
    const data = await res.json();
    addShipment(data.shipment_id);
    currentShipment = data.shipment_id;
    document.getElementById("status").innerText =
        "âœ… ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø´Ø­Ù†Ø©: " + data.shipment_id;
}

async function trackShipment(){
    if(!currentShipment) return;
    const res = await fetch(
        "http://127.0.0.1:8080/api/marine/track/" + currentShipment
    );
    const data = await res.json();
    document.getElementById("output").textContent =
        JSON.stringify(data, null, 2);
}
</script>

</body>
</html>